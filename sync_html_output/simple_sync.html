
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDFè®²è§£ - ç¬¬1é¡µ</title>
    <style>
/* åŒæ­¥PDF-è®²è§£å¸ƒå±€æ ·å¼ */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'SimHei', 'Microsoft YaHei', 'SimHei', sans-serif;
    font-size: 14pt;
    line-height: 1.2;
    color: #333;
    background-color: #ffffff;
    height: 100vh;
    overflow: hidden;
}

.sync-container {
    display: flex;
    height: 100vh;
    width: 100vw;
}

.pdf-panel {
    flex: 1;
    max-width: 50%;
    background: #f8f9fa;
    border-right: 1px solid #e0e0e0;
    display: flex;
    flex-direction: column;
    position: relative;
}

.pdf-viewer {
    flex: 1;
    position: relative;
    overflow: hidden;
}

.pdf-viewer embed,
.pdf-viewer iframe {
    width: 100%;
    height: 100%;
    border: none;
    background: white;
}

.pdf-controls {
    position: absolute;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 10px 20px;
    border-radius: 25px;
    display: flex;
    align-items: center;
    gap: 15px;
    z-index: 1000;
}

.pdf-controls button {
    background: #007bff;
    color: white;
    border: none;
    padding: 8px 12px;
    border-radius: 5px;
    cursor: pointer;
    font-size: 12pt;
    transition: background-color 0.2s;
}

.pdf-controls button:hover {
    background: #0056b3;
}

.pdf-controls button:disabled {
    background: #6c757d;
    cursor: not-allowed;
}

.page-info {
    font-size: 12pt;
    font-weight: bold;
    min-width: 80px;
    text-align: center;
}

.explanation-panel {
    flex: 1;
    max-width: 50%;
    background: white;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

.explanation-header {
    padding: 20px;
    background: #007bff;
    color: white;
    text-align: center;
    border-bottom: 3px solid #0056b3;
}

.explanation-header h2 {
    margin: 0;
    font-size: 18pt;
    font-weight: bold;
}

.explanation-content {
    flex: 1;
    overflow-y: auto;
    padding: 20px;
    line-height: 1.2;
}

.explanation-page {
    display: none;
    animation: fadeIn 0.3s ease-in-out;
}

.explanation-page.active {
    display: block;
}

.explanation-page h1,
.explanation-page h2,
.explanation-page h3,
.explanation-page h4 {
    color: #2c3e50;
    margin-bottom: 15px;
    line-height: 1.3;
}

.explanation-page h1 {
    font-size: 20pt;
    border-bottom: 2px solid #007bff;
    padding-bottom: 10px;
}

.explanation-page h2 {
    font-size: 18pt;
    color: #007bff;
}

.explanation-page h3 {
    font-size: 16pt;
}

.explanation-page p {
    margin-bottom: 15px;
    text-align: justify;
    text-justify: inter-word;
}

.explanation-page ul,
.explanation-page ol {
    margin-left: 20px;
    margin-bottom: 15px;
}

.explanation-page li {
    margin-bottom: 8px;
}

.explanation-page code {
    background: #f1f2f6;
    padding: 3px 6px;
    border-radius: 3px;
    font-family: 'Consolas', 'Monaco', monospace;
    font-size: 0.9em;
    color: #e74c3c;
}

.explanation-page pre {
    background: #f8f9fa;
    border: 1px solid #e9ecef;
    border-radius: 5px;
    padding: 15px;
    overflow-x: auto;
    margin: 15px 0;
    font-family: 'Consolas', 'Monaco', monospace;
    font-size: 11pt;
}

.explanation-page blockquote {
    border-left: 4px solid #007bff;
    padding-left: 15px;
    margin: 15px 0;
    font-style: italic;
    color: #6c757d;
    background: #f8f9fa;
    padding: 15px;
    border-radius: 0 5px 5px 0;
}

.explanation-page .highlight {
    background: #fff3cd;
    border: 1px solid #ffeaa7;
    border-radius: 5px;
    padding: 15px;
    margin: 15px 0;
}

.explanation-page .note {
    background: #d1ecf1;
    border: 1px solid #bee5eb;
    border-radius: 5px;
    padding: 15px;
    margin: 15px 0;
    border-left: 4px solid #17a2b8;
}

.explanation-page .warning {
    background: #f8d7da;
    border: 1px solid #f5c6cb;
    border-radius: 5px;
    padding: 15px;
    margin: 15px 0;
    border-left: 4px solid #dc3545;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

/* åŠ è½½æŒ‡ç¤ºå™¨ */
.loading {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    text-align: center;
    color: #6c757d;
}

.loading::after {
    content: '';
    display: inline-block;
    width: 20px;
    height: 20px;
    border: 2px solid #f3f3f3;
    border-top: 2px solid #007bff;
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin-left: 10px;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* å“åº”å¼è®¾è®¡ */
@media (max-width: 1024px) {
    .sync-container {
        flex-direction: column;
    }
    
    .pdf-panel,
    .explanation-panel {
        max-width: 100%;
        height: 50vh;
    }
    
    .pdf-controls {
        bottom: 10px;
        padding: 8px 15px;
    }
}

@media (max-width: 768px) {
    .explanation-header {
        padding: 15px;
    }
    
    .explanation-header h2 {
        font-size: 16pt;
    }
    
    .explanation-content {
        padding: 15px;
    }
    
    .pdf-controls {
        bottom: 5px;
        padding: 6px 12px;
        gap: 10px;
    }
    
    .pdf-controls button {
        padding: 6px 10px;
        font-size: 11pt;
    }
}

/* æ‰“å°æ ·å¼ */
@media print {
    .sync-container {
        flex-direction: column;
    }
    
    .pdf-controls,
    .loading {
        display: none;
    }
    
    .pdf-panel {
        max-width: 100%;
        height: 50vh;
        border-right: none;
        border-bottom: 1px solid #e0e0e0;
    }
    
    .explanation-panel {
        max-width: 100%;
    }
}
</style>
</head>
<body>
    <div class="sync-container">
        <!-- PDFæ˜¾ç¤ºé¢æ¿ -->
        <div class="pdf-panel">
            <div class="pdf-viewer">
                <iframe src="C:\Users\Kong\AppData\Local\Temp\tmpqdh2syh7\sample.pdf#page=1" 
                        id="pdf-frame"
                        frameborder="0">
                </iframe>
                <div class="loading">æ­£åœ¨åŠ è½½PDF...</div>
            </div>
            
            <!-- PDFæ§åˆ¶é¢æ¿ -->
            <div class="pdf-controls">
                <button id="prev-page" title="ä¸Šä¸€é¡µ (â†)">â€¹ ä¸Šä¸€é¡µ</button>
                <span class="page-info">1 / 3</span>
                <button id="next-page" title="ä¸‹ä¸€é¡µ (â†’)">ä¸‹ä¸€é¡µ â€º</button>
            </div>
        </div>
        
        <!-- è®²è§£æ˜¾ç¤ºé¢æ¿ -->
        <div class="explanation-panel">
            <div class="explanation-header">
                <h2>ğŸ“– é¡µé¢è®²è§£</h2>
            </div>
            <div class="explanation-content">
                
            <div class="explanation-page" id="explanation-page-1">
                <h1>ç¬¬ 1 é¡µ è®²è§£</h1>
                <p>è¿™æ˜¯ç¬¬ä¸€é¡µçš„è®²è§£å†…å®¹ã€‚æœ¬é¡µä¸»è¦ä»‹ç»æ–‡æ¡£çš„åŸºæœ¬ç»“æ„å’Œå†…å®¹æ¦‚è§ˆã€‚</p>
            </div>
            
            <div class="explanation-page" id="explanation-page-2">
                <h1>ç¬¬ 2 é¡µ è®²è§£</h1>
                <p>ç¬¬äºŒé¡µè®²è§£äº†ä¸»è¦æ¦‚å¿µå’Œç†è®ºåŸºç¡€ã€‚è¿™äº›æ¦‚å¿µæ˜¯ç†è§£åç»­å†…å®¹çš„åŸºç¡€ã€‚</p>
            </div>
            
            <div class="explanation-page" id="explanation-page-3">
                <h1>ç¬¬ 3 é¡µ è®²è§£</h1>
                <p>ç¬¬ä¸‰é¡µå±•ç¤ºäº†å…·ä½“çš„åº”ç”¨æ¡ˆä¾‹ã€‚é€šè¿‡å®ä¾‹å¯ä»¥æ›´å¥½åœ°ç†è§£ç†è®ºçŸ¥è¯†çš„å®é™…åº”ç”¨ã€‚</p>
            </div>
            
            </div>
        </div>
    </div>
    
    <script>
        
// PDF-è®²è§£åŒæ­¥åŠŸèƒ½
class PDFExplanationSync {
    constructor() {
        this.currentPage = 1;
        this.totalPages = 3;
        this.explanations = {
  "1": "è¿™æ˜¯ç¬¬ä¸€é¡µçš„è®²è§£å†…å®¹ã€‚æœ¬é¡µä¸»è¦ä»‹ç»æ–‡æ¡£çš„åŸºæœ¬ç»“æ„å’Œå†…å®¹æ¦‚è§ˆã€‚",
  "2": "ç¬¬äºŒé¡µè®²è§£äº†ä¸»è¦æ¦‚å¿µå’Œç†è®ºåŸºç¡€ã€‚è¿™äº›æ¦‚å¿µæ˜¯ç†è§£åç»­å†…å®¹çš„åŸºç¡€ã€‚",
  "3": "ç¬¬ä¸‰é¡µå±•ç¤ºäº†å…·ä½“çš„åº”ç”¨æ¡ˆä¾‹ã€‚é€šè¿‡å®ä¾‹å¯ä»¥æ›´å¥½åœ°ç†è§£ç†è®ºçŸ¥è¯†çš„å®é™…åº”ç”¨ã€‚"
};
        this.pdfViewer = null;
        this.init();
    }
    
    init() {
        this.setupPDFViewer();
        this.setupControls();
        this.loadExplanation(this.currentPage);
        this.updateUI();
    }
    
    setupPDFViewer() {
        this.pdfViewer = document.querySelector('.pdf-viewer iframe, .pdf-viewer embed');
        if (this.pdfViewer) {
            // ç›‘å¬PDFåŠ è½½å®Œæˆ
            this.pdfViewer.onload = () => {
                this.detectCurrentPage();
            };
            
            // å®šæœŸæ£€æŸ¥å½“å‰é¡µé¢ï¼ˆä½œä¸ºå¤‡ç”¨æ–¹æ¡ˆï¼‰
            setInterval(() => {
                this.detectCurrentPage();
            }, 2000);
        }
    }
    
    setupControls() {
        const prevBtn = document.getElementById('prev-page');
        const nextBtn = document.getElementById('next-page');
        
        if (prevBtn) {
            prevBtn.addEventListener('click', () => this.goToPrevPage());
        }
        
        if (nextBtn) {
            nextBtn.addEventListener('click', () => this.goToNextPage());
        }
    }
    
    detectCurrentPage() {
        try {
            // å°è¯•ä»PDFæŸ¥çœ‹å™¨è·å–å½“å‰é¡µé¢
            let pageNumber = this.currentPage;
            
            // æ–¹æ³•1: æ£€æŸ¥URL hash
            if (this.pdfViewer && this.pdfViewer.src) {
                const hashMatch = this.pdfViewer.src.match(/#page=(\d+)/);
                if (hashMatch) {
                    pageNumber = parseInt(hashMatch[1]);
                }
            }
            
            // æ–¹æ³•2: å¦‚æœæ˜¯Chrome PDFæŸ¥çœ‹å™¨ï¼Œå°è¯•ä»çª—å£è·å–é¡µé¢ä¿¡æ¯
            if (this.pdfViewer && this.pdfViewer.contentWindow) {
                try {
                    const pdfViewer = this.pdfViewer.contentWindow.document.querySelector('.page');
                    if (pdfViewer) {
                        const pageLabel = pdfViewer.querySelector('.pageNumber');
                        if (pageLabel) {
                            pageNumber = parseInt(pageLabel.textContent) || pageNumber;
                        }
                    }
                } catch (e) {
                    // è·¨åŸŸé™åˆ¶ï¼Œå¿½ç•¥é”™è¯¯
                }
            }
            
            // æ›´æ–°é¡µé¢ï¼ˆå¦‚æœå‘ç”Ÿå˜åŒ–ï¼‰
            if (pageNumber !== this.currentPage && pageNumber >= 1 && pageNumber <= this.totalPages) {
                this.goToPage(pageNumber);
            }
        } catch (e) {
            console.warn('æ— æ³•æ£€æµ‹PDFå½“å‰é¡µé¢:', e);
        }
    }
    
    goToPage(pageNumber) {
        if (pageNumber < 1 || pageNumber > this.totalPages) {
            return;
        }
        
        this.currentPage = pageNumber;
        this.updatePDFView();
        this.loadExplanation(pageNumber);
        this.updateUI();
    }
    
    goToPrevPage() {
        if (this.currentPage > 1) {
            this.goToPage(this.currentPage - 1);
        }
    }
    
    goToNextPage() {
        if (this.currentPage < this.totalPages) {
            this.goToPage(this.currentPage + 1);
        }
    }
    
    updatePDFView() {
        if (this.pdfViewer) {
            const currentSrc = this.pdfViewer.src;
            const baseUrl = currentSrc.split('#')[0];
            const newSrc = `${baseUrl}#page=${this.currentPage}`;
            
            if (currentSrc !== newSrc) {
                this.pdfViewer.src = newSrc;
            }
        }
    }
    
    loadExplanation(pageNumber) {
        // éšè—æ‰€æœ‰è®²è§£é¡µé¢
        document.querySelectorAll('.explanation-page').forEach(page => {
            page.classList.remove('active');
        });
        
        // æ˜¾ç¤ºå¯¹åº”çš„è®²è§£é¡µé¢
        const targetPage = document.getElementById(`explanation-page-${pageNumber}`);
        if (targetPage) {
            targetPage.classList.add('active');
        } else {
            // å¦‚æœæ²¡æœ‰å¯¹åº”çš„è®²è§£é¡µé¢ï¼Œåˆ›å»ºé»˜è®¤é¡µé¢
            this.createDefaultExplanationPage(pageNumber);
        }
        
        // æ»šåŠ¨åˆ°é¡¶éƒ¨
        const explanationContent = document.querySelector('.explanation-content');
        if (explanationContent) {
            explanationContent.scrollTop = 0;
        }
    }
    
    createDefaultExplanationPage(pageNumber) {
        const explanationContent = document.querySelector('.explanation-content');
        if (explanationContent) {
            // ç§»é™¤ç°æœ‰çš„é»˜è®¤é¡µé¢
            const existingPage = document.getElementById(`explanation-page-${pageNumber}`);
            if (existingPage) {
                existingPage.remove();
            }
            
            // åˆ›å»ºæ–°çš„è®²è§£é¡µé¢
            const pageDiv = document.createElement('div');
            pageDiv.id = `explanation-page-${pageNumber}`;
            pageDiv.className = 'explanation-page active';
            
            const explanation = this.explanations[pageNumber] || 'æš‚æ— è®²è§£å†…å®¹';
            pageDiv.innerHTML = `
                <h1>ç¬¬ ${pageNumber} é¡µ è®²è§£</h1>
                <div class="note">
                    <p><strong>æ³¨æ„ï¼š</strong> å½“å‰é¡µé¢æš‚æ— è¯¦ç»†è®²è§£å†…å®¹ã€‚</p>
                </div>
                ${explanation ? `<div class="explanation-text">${this.formatExplanation(explanation)}</div>` : ''}
            `;
            
            explanationContent.appendChild(pageDiv);
        }
    }
    
    formatExplanation(text) {
        if (!text) return '';
        
        // ç®€å•çš„Markdownè½¬HTMLï¼ˆå¯æ ¹æ®éœ€è¦æ‰©å±•ï¼‰
        return text
            .replace(/\\n\\n/g, '</p><p>')
            .replace(/\\n/g, '<br>')
            .replace(/^/, '<p>')
            .replace(/$/, '</p>');
    }
    
    updateUI() {
        // æ›´æ–°é¡µç æ˜¾ç¤º
        const pageInfo = document.querySelector('.page-info');
        if (pageInfo) {
            pageInfo.textContent = `${this.currentPage} / ${this.totalPages}`;
        }
        
        // æ›´æ–°æŒ‰é’®çŠ¶æ€
        const prevBtn = document.getElementById('prev-page');
        const nextBtn = document.getElementById('next-page');
        
        if (prevBtn) {
            prevBtn.disabled = this.currentPage <= 1;
        }
        
        if (nextBtn) {
            nextBtn.disabled = this.currentPage >= this.totalPages;
        }
        
        // æ›´æ–°é¡µé¢æ ‡é¢˜
        document.title = `ç¬¬${this.currentPage}é¡µ - PDFè®²è§£`;
    }
    
    // é”®ç›˜å¯¼èˆªæ”¯æŒ
    setupKeyboardNavigation() {
        document.addEventListener('keydown', (e) => {
            switch(e.key) {
                case 'ArrowLeft':
                case 'ArrowUp':
                    e.preventDefault();
                    this.goToPrevPage();
                    break;
                case 'ArrowRight':
                case 'ArrowDown':
                case ' ':
                    e.preventDefault();
                    this.goToNextPage();
                    break;
                case 'Home':
                    e.preventDefault();
                    this.goToPage(1);
                    break;
                case 'End':
                    e.preventDefault();
                    this.goToPage(this.totalPages);
                    break;
            }
        });
    }
}

// é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
document.addEventListener('DOMContentLoaded', function() {
    // ç§»é™¤åŠ è½½æŒ‡ç¤ºå™¨
    const loading = document.querySelector('.loading');
    if (loading) {
        loading.remove();
    }
    
    // åˆå§‹åŒ–åŒæ­¥åŠŸèƒ½
    window.pdfSync = new PDFExplanationSync();
    
    // è®¾ç½®é”®ç›˜å¯¼èˆª
    window.pdfSync.setupKeyboardNavigation();
    
    console.log('PDF-è®²è§£åŒæ­¥åŠŸèƒ½å·²åˆå§‹åŒ–');
});

// æš´éœ²ä¸€äº›å…¨å±€æ–¹æ³•ä¾›å¤–éƒ¨è°ƒç”¨
window.goToPage = function(pageNumber) {
    if (window.pdfSync) {
        window.pdfSync.goToPage(pageNumber);
    }
};

window.nextPage = function() {
    if (window.pdfSync) {
        window.pdfSync.goToNextPage();
    }
};

window.prevPage = function() {
    if (window.pdfSync) {
        window.pdfSync.goToPrevPage();
    }
};

    </script>
</body>
</html>
